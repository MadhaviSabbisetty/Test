<Autocomplete
  value={branch}
  options={
    branchHasMore
      ? [...branchList, SHOW_MORE_OPTION]
      : branchList
  }
  loading={branchLoading}
  disabled={!circle}
  getOptionLabel={(option) =>
    option.__type === "SHOW_MORE"
      ? option.label
      : `${option.branchCode} - ${option.branchName}`
  }
  isOptionEqualToValue={(o, v) =>
    o.__type === "SHOW_MORE"
      ? false
      : o.branchCode === v.branchCode
  }
  onChange={(e, value) => {
    if (!value) return;

    if (value.__type === "SHOW_MORE") {
      fetchBranches(circle, branchPage + 1);
      return;
    }

    setBranch(value);
  }}
  renderOption={(props, option) => {
    if (option.__type === "SHOW_MORE") {
      return (
        <li {...props} style={{ textAlign: "center", fontWeight: 600 }}>
          ðŸ”½ Show more branchesâ€¦
        </li>
      );
    }
    return (
      <li {...props}>
        {option.branchCode} - {option.branchName}
      </li>
    );
  }}
  renderInput={(params) => (
    <TextField
      {...params}
      label="Select Branch"
      InputProps={{
        ...params.InputProps,
        endAdornment: (
          <>
            {branchLoading && <CircularProgress size={20} />}
            {params.InputProps.endAdornment}
          </>
        ),
      }}
    />
  )}
/>
